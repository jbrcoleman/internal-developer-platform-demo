# This is the schema developers will use to define their applications
# The platform will generate full Kubernetes manifests from this

apiVersion: platform.grow.io/v1alpha1
kind: Application
metadata:
  name: example-app
spec:
  # Runtime configuration
  runtime:
    image: sample-service:v1
    port: 8080
    resources:
      cpu: 100m
      memory: 256Mi
    env:
      - name: LOG_LEVEL
        value: info

  # Deployment strategy
  deployment:
    replicas: 3
    strategy: canary  # or: rolling, blueGreen

    # Canary-specific settings
    canary:
      steps:
        - weight: 20
          pause: 5m
        - weight: 50
          pause: 10m

      # Enable automated analysis
      analysis:
        enabled: true
        errorRateThreshold: 0.05  # 5%
        latencyP95Threshold: 500  # 500ms

  # Networking
  networking:
    expose: true
    domain: app.local  # Will create Ingress

  # Observability
  observability:
    metrics:
      enabled: true
      port: 8080
      path: /metrics
